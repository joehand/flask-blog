<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>{% block title %}Joe Hand Blog{% endblock title %}</title>
        <meta name="description" content="{% block description %}{% endblock description %}">
        
        <link rel="stylesheet" href="{{url_for('static', filename='css/normalize.css')}}">
        <link rel="stylesheet" href="{{url_for('static', filename='css/main.css')}}">
        {%- block additional_css %}{% endblock -%}
        {%- block header_js %}{% endblock %}
    </head>
    <body class="{% block body_class %}{% endblock %}">

    {%- block navbar %}
        {% for page in g.pages %}
        <ul>
            <li><a href="{{url_for('blog.page', slug=page.slug)}}"><b>{{page.title}}</b></a></li>
        </ul>
        {% endfor %}
    {%- endblock -%}

    {%- block container %}
        <div id="main" class="container"> 
            {%- with messages = get_flashed_messages() %}
                  {% if messages %}
                    <ul class=flashes>
                    {% for message in messages %}
                        <li>{{ message }}</li>
                    {% endfor %}
                    </ul>
                  {% endif %}
            {%- endwith %}

            {%- block content %}
            {% endblock content %} 

            {%- block footer %}
            {% endblock footer %}
        </div> <!-- /container -->
    {%- endblock %}

    {%- if current_user.has_role('admin') %}
        <script>
            {% if current_user.is_authenticated() -%}
            {%- block post_js %}
            var postsBootstrap = [{% for post in g.posts %}{{post.to_dict()|safe}},{% endfor %}];
            {%- endblock post_js %}
            var childView = {%- block js_view %}null{%- endblock js_view -%};
            {%- endif %}
            var postURL = '{{url_for('admin.PostAdmin:index')}}';
        </script>
    {%- block footer_js %}
        <script>
            {% if current_user.is_authenticated() -%}
            var currentUser = {
                                'id'     : '{{current_user.id}}',
                                'roles'  : [{% for role in current_user.roles %}'{{role.name}}'{% endfor %}],
                                'email'  : '{{current_user.email}}'
                              };
            {%- else %}
            var currentUser = false;
            {%- endif %}
        </script>
        <script data-main="{{ url_for('static', filename='js/app')}}" src="{{ url_for('static', filename='js/libs/require.js')}}"></script>
    {% endblock footer_js -%}
    {%- endif -%}
    </body>
</html>

